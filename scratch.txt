word ackbuf [MAX_ACK_PAYLEN];
byte bm_fill;		// Nonzero if building bitmap
lword base,		// Assumed base
	bk_last;	// Last block stored as offset (potential bm base)




void add_missing (lword bn) {

	if (









	if (in_bitmap) {
		if (bn - bm_base > 15) {
			// End of bitmap
			if (bm_fill < 2)
				replace_bm_with_direct_bm_base
			goto add_as_block;
		}
		add_to_bitmap;
		return;
	}

add_as_block;

	if (overflow)
		shift_rebase;

	add_as_block;
}
